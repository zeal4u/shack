<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.8.5">
  <compounddef id="bank__machine_8h" kind="file">
    <compoundname>bank_machine.h</compoundname>
    <includes refid="withdraw_8h" local="yes">withdraw.h</includes>
    <includes refid="receiver_8h" local="yes">receiver.h</includes>
    <includedby refid="main_8cpp" local="yes">/root/Public/shack/atm/main.cpp</includedby>
    <incdepgraph>
      <node id="232">
        <label>queue</label>
      </node>
      <node id="229">
        <label>queue.h</label>
        <link refid="queue_8h"/>
        <childnode refid="230" relation="include">
        </childnode>
        <childnode refid="231" relation="include">
        </childnode>
        <childnode refid="232" relation="include">
        </childnode>
        <childnode refid="233" relation="include">
        </childnode>
      </node>
      <node id="234">
        <label>string</label>
      </node>
      <node id="228">
        <label>sender.h</label>
        <link refid="sender_8h"/>
        <childnode refid="229" relation="include">
        </childnode>
      </node>
      <node id="227">
        <label>withdraw.h</label>
        <link refid="withdraw_8h"/>
        <childnode refid="228" relation="include">
        </childnode>
        <childnode refid="234" relation="include">
        </childnode>
      </node>
      <node id="235">
        <label>receiver.h</label>
        <link refid="receiver_8h"/>
        <childnode refid="229" relation="include">
        </childnode>
        <childnode refid="228" relation="include">
        </childnode>
        <childnode refid="236" relation="include">
        </childnode>
      </node>
      <node id="237">
        <label>template_dispatcher.h</label>
        <link refid="template__dispatcher_8h"/>
        <childnode refid="229" relation="include">
        </childnode>
      </node>
      <node id="231">
        <label>condition_variable</label>
      </node>
      <node id="236">
        <label>dispatcher.h</label>
        <link refid="dispatcher_8h"/>
        <childnode refid="229" relation="include">
        </childnode>
        <childnode refid="237" relation="include">
        </childnode>
        <childnode refid="238" relation="include">
        </childnode>
      </node>
      <node id="238">
        <label>utility</label>
      </node>
      <node id="226">
        <label>/root/Public/shack/atm/bank_machine.h</label>
        <link refid="bank_machine.h"/>
        <childnode refid="227" relation="include">
        </childnode>
        <childnode refid="235" relation="include">
        </childnode>
      </node>
      <node id="230">
        <label>mutex</label>
      </node>
      <node id="233">
        <label>memory</label>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="240">
        <label>/root/Public/shack/atm/main.cpp</label>
        <link refid="main_8cpp"/>
      </node>
      <node id="239">
        <label>/root/Public/shack/atm/bank_machine.h</label>
        <link refid="bank_machine.h"/>
        <childnode refid="240" relation="include">
        </childnode>
      </node>
    </invincdepgraph>
    <innerclass refid="classBankMachine" prot="public">BankMachine</innerclass>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Created<sp/>by<sp/>zeal4u<sp/>on<sp/>2019/3/28.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Author<sp/>:<sp/>zeal4u</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Email<sp/>:<sp/>jsz1995@live.com</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Description<sp/>:<sp/>Bank<sp/>state<sp/>machine</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>SHACK_BANK_MACHINE_H</highlight></codeline>
<codeline lineno="9"><highlight class="preprocessor"></highlight><highlight class="preprocessor">#define<sp/>SHACK_BANK_MACHINE_H</highlight></codeline>
<codeline lineno="10"><highlight class="preprocessor"></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="withdraw_8h" kindref="compound">withdraw.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="receiver_8h" kindref="compound">receiver.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight></codeline>
<codeline lineno="14" refid="classBankMachine" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal"><ref refid="classBankMachine" kindref="compound">BankMachine</ref><sp/>{</highlight></codeline>
<codeline lineno="15"><highlight class="normal"><sp/></highlight><highlight class="keyword">public</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="16" refid="classBankMachine_1aafdb9bf4f04bec9c6ac3b9ec2229843e" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="classBankMachine_1aafdb9bf4f04bec9c6ac3b9ec2229843e" kindref="member">BankMachine</ref>()<sp/>:<sp/><ref refid="classBankMachine_1ad299fdb18b1ee6e66374f70dde18d584" kindref="member">balance_</ref>(199)<sp/>{}</highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight></codeline>
<codeline lineno="18" refid="classBankMachine_1afaf799b68e5965bb473cee993fffee74" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classBankMachine_1afaf799b68e5965bb473cee993fffee74" kindref="member">Done</ref>()<sp/>{</highlight></codeline>
<codeline lineno="19"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="classBankMachine_1a5d8bf0c5b153073a6bfa76bd2ee29acb" kindref="member">GetSender</ref>().<ref refid="classmessaging_1_1Sender_1a5f8d8f2fa560996d8f224cc0f10d8f8c" kindref="member">Send</ref>(<ref refid="classmessaging_1_1CloseQueue" kindref="compound">messaging::CloseQueue</ref>());</highlight></codeline>
<codeline lineno="20"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight></codeline>
<codeline lineno="22" refid="classBankMachine_1adba1d635c9837305c1e0fe4f70efdcdb" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="classBankMachine_1adba1d635c9837305c1e0fe4f70efdcdb" kindref="member">Run</ref>()<sp/>{</highlight></codeline>
<codeline lineno="23"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">try</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="24"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">true</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="25"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classBankMachine_1a80fe063f235cf02d33a2d70aeef6048c" kindref="member">incoming_</ref>.<ref refid="classmessaging_1_1Receiver_1a3f0e7b541159793eaec1e0fa6802d4d2" kindref="member">Wait</ref>().<ref refid="classmessaging_1_1Dispatcher_1a6d9d0bf1da266ca951c7821bc4e84f9f" kindref="member">Handle</ref>&lt;<ref refid="structVerifyPin" kindref="compound">VerifyPin</ref>&gt;(</highlight></codeline>
<codeline lineno="26"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[&amp;](</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structVerifyPin" kindref="compound">VerifyPin</ref><sp/>&amp;msg)<sp/>{</highlight></codeline>
<codeline lineno="27"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(msg.pin_<sp/>==<sp/></highlight><highlight class="stringliteral">&quot;1937&quot;</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="28"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>msg.atm_queue_.Send(<ref refid="structPinVerified" kindref="compound">PinVerified</ref>());</highlight></codeline>
<codeline lineno="29"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="30"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>msg.atm_queue_.Send(<ref refid="structPinIncorrect" kindref="compound">PinIncorrect</ref>());<sp/></highlight></codeline>
<codeline lineno="31"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="32"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight></codeline>
<codeline lineno="33"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>).Handle&lt;Withdraw&gt;(</highlight></codeline>
<codeline lineno="34"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[&amp;](</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structWithdraw" kindref="compound">Withdraw</ref><sp/>&amp;msg)<sp/>{</highlight></codeline>
<codeline lineno="35"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="classBankMachine_1ad299fdb18b1ee6e66374f70dde18d584" kindref="member">balance_</ref><sp/>&gt;=<sp/>msg.<ref refid="structWithdraw_1aef16f3caa8a813007062a23d06ee4297" kindref="member">amount_</ref>)<sp/>{</highlight></codeline>
<codeline lineno="36"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>msg.<ref refid="structWithdraw_1ab629acf79446ce7dd973ed3c97c1c99c" kindref="member">atm_queue_</ref>.<ref refid="classmessaging_1_1Sender_1a5f8d8f2fa560996d8f224cc0f10d8f8c" kindref="member">Send</ref>(<ref refid="structWithdrawOK" kindref="compound">WithdrawOK</ref>());</highlight></codeline>
<codeline lineno="37"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="classBankMachine_1ad299fdb18b1ee6e66374f70dde18d584" kindref="member">balance_</ref><sp/>-=<sp/>msg.<ref refid="structWithdraw_1aef16f3caa8a813007062a23d06ee4297" kindref="member">amount_</ref>;<sp/></highlight></codeline>
<codeline lineno="38"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="39"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>msg.<ref refid="structWithdraw_1ab629acf79446ce7dd973ed3c97c1c99c" kindref="member">atm_queue_</ref>.<ref refid="classmessaging_1_1Sender_1a5f8d8f2fa560996d8f224cc0f10d8f8c" kindref="member">Send</ref>(<ref refid="structWithdrawDenied" kindref="compound">WithdrawDenied</ref>());<sp/></highlight></codeline>
<codeline lineno="40"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="41"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/><sp/></highlight></codeline>
<codeline lineno="42"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>).Handle&lt;GetBalance&gt;(</highlight></codeline>
<codeline lineno="43"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[&amp;](</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structGetBalance" kindref="compound">GetBalance</ref><sp/>&amp;msg)<sp/>{</highlight></codeline>
<codeline lineno="44"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>msg.<ref refid="structGetBalance_1a469a494592b15655be79bc85c7202750" kindref="member">atm_queue_</ref>.<ref refid="classmessaging_1_1Sender_1a5f8d8f2fa560996d8f224cc0f10d8f8c" kindref="member">Send</ref>(<ref refid="structBalance" kindref="compound">Balance</ref>(<ref refid="classBankMachine_1ad299fdb18b1ee6e66374f70dde18d584" kindref="member">balance_</ref>));<sp/></highlight></codeline>
<codeline lineno="45"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}<sp/><sp/></highlight></codeline>
<codeline lineno="46"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>).Handle&lt;WithdrawProcessed&gt;(</highlight></codeline>
<codeline lineno="47"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[&amp;](</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structWithdrawProcessed" kindref="compound">WithdrawProcessed</ref><sp/>&amp;msg)<sp/>{}</highlight></codeline>
<codeline lineno="48"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>).Handle&lt;CancelWithdrawal&gt;(</highlight></codeline>
<codeline lineno="49"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>[&amp;](</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structCancelWithdrawal" kindref="compound">CancelWithdrawal</ref><sp/>&amp;msg)<sp/>{}<sp/><sp/></highlight></codeline>
<codeline lineno="50"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="51"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="52"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">catch</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="classmessaging_1_1CloseQueue" kindref="compound">messaging::CloseQueue</ref><sp/>&amp;)<sp/>{}</highlight></codeline>
<codeline lineno="53"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="54"><highlight class="normal"></highlight></codeline>
<codeline lineno="55" refid="classBankMachine_1a5d8bf0c5b153073a6bfa76bd2ee29acb" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="classmessaging_1_1Sender" kindref="compound">messaging::Sender</ref><sp/><ref refid="classBankMachine_1a5d8bf0c5b153073a6bfa76bd2ee29acb" kindref="member">GetSender</ref>()<sp/>{</highlight></codeline>
<codeline lineno="56"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="classBankMachine_1a80fe063f235cf02d33a2d70aeef6048c" kindref="member">incoming_</ref>;</highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="58"><highlight class="normal"><sp/></highlight><highlight class="keyword">private</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="59" refid="classBankMachine_1a80fe063f235cf02d33a2d70aeef6048c" refkind="member"><highlight class="normal"><sp/><sp/><ref refid="classmessaging_1_1Receiver" kindref="compound">messaging::Receiver</ref><sp/><ref refid="classBankMachine_1a80fe063f235cf02d33a2d70aeef6048c" kindref="member">incoming_</ref>;</highlight></codeline>
<codeline lineno="60" refid="classBankMachine_1ad299fdb18b1ee6e66374f70dde18d584" refkind="member"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/><ref refid="classBankMachine_1ad299fdb18b1ee6e66374f70dde18d584" kindref="member">balance_</ref>;</highlight></codeline>
<codeline lineno="61"><highlight class="normal">};</highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight><highlight class="preprocessor">#endif<sp/>//SHACK_BANK_MACHINE_H</highlight></codeline>
    </programlisting>
    <location file="/root/Public/shack/atm/bank_machine.h"/>
  </compounddef>
</doxygen>
